# 💰 نظام تسليم الرواتب - مجموعة الشهباء التجارية

## 🎯 الميزات الجديدة المضافة

### 1. 💰 زر "تم التسليم" في التقارير الأسبوعية
- يظهر بجانب كل موظف له مستحقات
- يسجل عملية تسليم الراتب تلقائياً
- يخصم المبلغ من المستحقات المتبقية

### 2. 🔄 نظام إدارة مالي شامل
- **خصومات**: تُخصم من راتب الأسبوع الحالي
- **سلف**: تُخصم من راتب الأسبوع المقبل
- **تسليم رواتب**: يُسجل المبلغ المدفوع ويُخصم من المستحقات
- **نظام التتبع**: كل عملية مؤرخة ومرفقة بسبب

### 3. 📊 البيان المالي المحسن للموظفين
- عرض العمليات المالية لكل أسبوع
- إظهار السلف والخصومات والمدفوعات
- حساب صافي المبلغ المستحق بدقة
- أزرار طباعة وتصدير محسنة

## 🛠️ كيفية استخدام النظام

### للإدارة:

#### 1. إضافة خصم أو سلفة
```text
1. اذهب إلى تبويب "الشؤون المالية"
2. اختر الموظف
3. اختر نوع العملية:
   - خصم: يُخصم من راتب الأسبوع الحالي
   - سلفة: تُخصم من راتب الأسبوع المقبل
   - تسليم راتب: يُسجل المبلغ المدفوع
4. أدخل المبلغ والسبب
5. اضغط "إضافة"
```

#### 2. تسجيل تسليم راتب
```text
الطريقة الأولى - من التقرير الأسبوعي:
1. اذهب إلى تبويب "التقارير"
2. اختر الأسبوع المطلوب
3. اضغط "تم التسليم" بجانب الموظف
4. أكد العملية

الطريقة الثانية - من الشؤون المالية:
1. اذهب إلى تبويب "الشؤون المالية"
2. اختر الموظف
3. اختر "تسليم راتب"
4. أدخل المبلغ والسبب
5. اضغط "إضافة"
```

#### 3. مراجعة المستحقات
```text
1. اذهب إلى تبويب "التقارير"
2. اختر الأسبوع المطلوب
3. راجع عمود "صافي المبلغ المستحق"
4. الأرقام الموجبة = مستحقات للموظف
5. الأرقام السالبة = دين على الموظف
```

### للموظفين:

#### 1. مراجعة البيان المالي
```text
1. سجل دخول كموظف
2. اذهب إلى قسم "البيان المالي"
3. اختر الأسبوع المطلوب
4. راجع:
   - ساعات العمل
   - المبلغ المستحق
   - الخصومات
   - السلف
   - المدفوع مسبقاً
   - صافي المبلغ
```

#### 2. طباعة أو تصدير البيان
```text
1. من قسم "البيان المالي"
2. اختر الأسبوع المطلوب
3. اضغط:
   - "طباعة البيان المالي" للطباعة
   - "تصدير Excel" لحفظ ملف CSV
```

## 🧮 كيفية حساب المستحقات

### معادلة الحساب:
```
المبلغ الأولي = (ساعات العمل × معدل الساعة)
الخصومات = مجموع خصومات الأسبوع
السلف = مجموع سلف الأسبوع الحالي + سلف الأسبوع السابق
المدفوعات = مجموع المبالغ المدفوعة مسبقاً

صافي المبلغ = المبلغ الأولي - الخصومات - السلف - المدفوعات
```

### مثال عملي:
```
موظف عمل 40 ساعة بمعدل 15 ريال/ساعة
المبلغ الأولي = 40 × 15 = 600 ريال

خصومات الأسبوع = 50 ريال (غياب بدون إذن)
سلف الأسبوع السابق = 200 ريال (سلفة طلبها الأسبوع الماضي)
سلف الأسبوع الحالي = 0 ريال
مدفوعات سابقة = 0 ريال (لم يتم دفع شيء مسبقاً)

صافي المبلغ = 600 - 50 - 200 - 0 = 350 ريال
```

## 🎨 التحسينات المرئية

### 1. ألوان مميزة للعمليات
- **🟢 أخضر**: تسليم رواتب
- **🔴 أحمر**: خصومات
- **🔵 أزرق**: سلف
- **🟡 أصفر**: صافي المبلغ المستحق

### 2. أزرار محسنة
- زر "تم التسليم" بتصميم ذهبي لافت
- أزرار الطباعة والتصدير محسنة
- تأثيرات بصرية عند التفاعل

### 3. جداول محسنة
- عرض واضح للعمليات المالية
- ترتيب زمني للمعاملات
- ألوان مختلفة حسب نوع العملية

## 📱 الاستجابة للجوال

- جميع الميزات تعمل على الجوال
- أزرار محسنة للمس
- جداول قابلة للتمرير الأفقي
- تصميم متجاوب كامل

## 🔧 إعدادات قاعدة البيانات

### للمستخدمين الجدد:
استخدم كود SQL المحدث من تبويب "إعدادات Supabase"

### للمستخدمين الحاليين:
أضف هذا الكود لتحديث قاعدة البيانات:

```sql
-- إضافة دعم تسليم الرواتب
ALTER TABLE finances ADD COLUMN week_paid TEXT;
ALTER TABLE finances DROP CONSTRAINT IF EXISTS finances_type_check;
ALTER TABLE finances ADD CONSTRAINT finances_type_check CHECK (type IN ('deduction', 'advance', 'payment'));
```

## 🎯 المزايا الرئيسية

### 1. دقة مالية عالية
- حساب دقيق للمستحقات
- تتبع جميع العمليات المالية
- منع الأخطاء البشرية

### 2. شفافية كاملة
- الموظف يرى بياناته المالية
- سجل كامل لجميع المعاملات
- إمكانية الطباعة والتصدير

### 3. سهولة الاستخدام
- زر واحد لتسجيل تسليم الراتب
- واجهة بديهية ومفهومة
- عمليات سريعة ودقيقة

### 4. مرونة في الإدارة
- دعم عملات متعددة
- أنواع مختلفة من العمليات المالية
- تخصيص حسب احتياجات الشركة

## 🚀 الخطوات التالية

1. **اختبار النظام**: جرب جميع الميزات الجديدة
2. **تدريب المستخدمين**: علم الإدارة كيفية استخدام النظام
3. **إدخال البيانات**: أضف الموظفين والفروع
4. **بدء الاستخدام**: ابدأ بتسجيل الحضور والعمليات المالية

## 📞 الدعم الفني

عند مواجهة أي مشاكل:
1. تحقق من اتصال الإنترنت
2. راجع إعدادات قاعدة البيانات
3. تأكد من صلاحيات المستخدمين
4. اطلب المساعدة من فريق الدعم

---

## 🎖️ مجموعة الشهباء التجارية
**نظام إدارة الموارد البشرية المتطور**
*تصميم عصري • أداء عالي • سهولة استخدام* 